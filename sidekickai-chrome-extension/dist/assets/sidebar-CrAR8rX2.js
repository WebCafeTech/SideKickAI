import{j as r,r as S,D as q,g as N,c as H}from"./styles-Dyly2VZX.js";function U(p){if(!p)return p;const i=p.split(`
`),t=[];let w=!1,e=[],c=[],k=!1,n=null;for(let l=0;l<i.length;l++){const d=i[l];if(d.trim().startsWith("```")){if(w)t.push(r.jsx("pre",{style:{background:"rgba(0,0,0,0.3)",padding:"12px",borderRadius:"6px",overflow:"auto",margin:"8px 0",fontSize:"13px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:r.jsx("code",{children:e.join(`
`)})},`code-${l}`)),e=[],w=!1;else{c.length>0&&(t.push($(c,n,l)),c=[],k=!1,n=null),w=!0;const o=d.trim().substring(3).trim();o&&e.push(`// ${o}`)}continue}if(w){e.push(d);continue}const m=d.match(/^(\d+)\.\s+(.+)$/);if(m){k&&n!=="ol"&&(t.push($(c,n,l)),c=[]),k=!0,n="ol",c.push(P(m[2]));continue}const b=d.match(/^[-*â€¢]\s+(.+)$/);if(b){k&&n!=="ul"&&(t.push($(c,n,l)),c=[]),k=!0,n="ul",c.push(P(b[1]));continue}if(k&&d.trim()===""){t.push($(c,n,l)),c=[],k=!1,n=null,t.push(r.jsx("br",{},`br-${l}`));continue}if(k&&d.trim()!==""){const o=d.match(/^\s{2,}(.+)$/);if(o){c.push(P(o[1]));continue}else t.push($(c,n,l)),c=[],k=!1,n=null}d.trim()===""?t.push(r.jsx("br",{},`br-empty-${l}`)):t.push(r.jsx("div",{style:{marginBottom:"4px"},children:P(d)},`line-${l}`))}return k&&c.length>0&&t.push($(c,n,i.length)),w&&e.length>0&&t.push(r.jsx("pre",{style:{background:"rgba(0,0,0,0.3)",padding:"12px",borderRadius:"6px",overflow:"auto",margin:"8px 0",fontSize:"13px",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:r.jsx("code",{children:e.join(`
`)})},"code-end")),r.jsx("div",{children:t})}function $(p,i,t){if(p.length===0)return null;const w=i==="ol"?"ol":"ul";return r.jsx(w,{style:{margin:"8px 0",paddingLeft:"24px",lineHeight:"1.6"},children:p.map((e,c)=>r.jsx("li",{style:{marginBottom:"4px"},children:e},`item-${t}-${c}`))},`list-${t}`)}function P(p){if(!p)return p;const i=[];let t=0;const w=[{regex:/`([^`]+)`/g,priority:1,render:(n,l)=>r.jsx("code",{style:{background:"rgba(0,0,0,0.3)",padding:"2px 6px",borderRadius:"4px",fontFamily:"monospace",fontSize:"0.9em"},children:l},`code-${t++}`)},{regex:/\[([^\]]+)\]\(([^)]+)\)/g,priority:2,render:(n,l,d)=>{let m=d.trim();return m.match(/^https?:\/\//i)||(m="https://"+m),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#60a5fa",textDecoration:"underline",cursor:"pointer",wordBreak:"break-all",transition:"color 0.2s"},onClick:b=>{b.preventDefault(),typeof chrome<"u"&&chrome.tabs&&chrome.tabs.create?chrome.tabs.create({url:m}):window.open(m,"_blank","noopener,noreferrer")},onMouseEnter:b=>{b.target.style.color="#93c5fd"},onMouseLeave:b=>{b.target.style.color="#60a5fa"},children:l},`link-${t++}`)}},{regex:/\*\*([^*]+)\*\*|__([^_]+)__/g,priority:3,render:(n,l,d)=>r.jsx("strong",{style:{fontWeight:"bold"},children:l||d},`bold-${t++}`)},{regex:/\*([^*\n]+?)\*|_([^_\n]+?)_/g,priority:4,render:(n,l,d)=>n.startsWith("**")||n.endsWith("**")||n.startsWith("__")||n.endsWith("__")?null:r.jsx("em",{style:{fontStyle:"italic"},children:l||d},`italic-${t++}`)},{regex:/<u>([^<]+)<\/u>/g,priority:5,render:(n,l)=>r.jsx("u",{style:{textDecoration:"underline"},children:l},`underline-${t++}`)}],e=[],c=[];w.sort((n,l)=>n.priority-l.priority),w.forEach(({regex:n,render:l,priority:d})=>{let m;for(n.lastIndex=0;(m=n.exec(p))!==null;){const b=m.index,o=m.index+m[0].length;if(!c.some(x=>!(o<=x.start||b>=x.end))){const x=l(m[0],m[1],m[2]);x!==null&&(e.push({start:b,end:o,render:()=>x,original:m[0],priority:d}),c.push({start:b,end:o}))}}});let k=0;return e.forEach(n=>{if(n.start>k){const l=p.substring(k,n.start);l&&i.push(l)}i.push(n.render()),k=n.end}),k<p.length&&i.push(p.substring(k)),i.length===0?p:i}function O({settings:p,theme:i}){const t=(i==null?void 0:i.colors)||{},[w,e]=S.useState([{role:"assistant",text:`ðŸ‘‹ Welcome to SidekickAI! I can help you with:

â€¢ Reading content from the left side of the page
â€¢ Answering quiz questions (MCQ)
â€¢ General questions and assistance

ðŸ’¡ **Tip:** Don't have an API key? Click the "ðŸ’¬ ChatGPT" button in the header to use ChatGPT's web interface instead!

Try clicking "Read Left" or "Answer Quiz" buttons, or ask me anything!`}]),[c,k]=S.useState(""),[n,l]=S.useState(null),[d,m]=S.useState(!1),b=S.useRef(),o=S.useRef(0),f=S.useRef(null),x=()=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 0"},children:[r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:t.text||"#e6eef6",opacity:.4,animation:"typing 1.4s infinite ease-in-out",animationDelay:"0s"}}),r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:t.text||"#e6eef6",opacity:.4,animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.2s"}}),r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:t.text||"#e6eef6",opacity:.4,animation:"typing 1.4s infinite ease-in-out",animationDelay:"0.4s"}})]});S.useEffect(()=>{const s="typing-animation-style";let a=document.getElementById(s);return a||(a=document.createElement("style"),a.id=s,document.head.appendChild(a)),a.textContent=`
      @keyframes typing {
        0%, 60%, 100% {
          transform: translateY(0);
          opacity: 0.4;
        }
        30% {
          transform: translateY(-10px);
          opacity: 1;
        }
      }
      @keyframes messageSlideIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .message-enter {
        animation: messageSlideIn 0.3s ease-out;
      }
    `,()=>{a&&a.parentNode&&a.parentNode.removeChild(a)}},[]),S.useEffect(()=>{const s="chat-scrollbar-theme-style";let a=document.getElementById(s);return a||(a=document.createElement("style"),a.id=s,document.head.appendChild(a)),a.textContent=`
      .chat::-webkit-scrollbar { width: 6px; }
      .chat::-webkit-scrollbar-track { background: ${t.panel||"rgba(255,255,255,0.02)"}; border-radius: 3px; }
      .chat::-webkit-scrollbar-thumb { background: ${t.scrollbar||"rgba(45,212,191,0.3)"}; border-radius: 3px; }
      .chat::-webkit-scrollbar-thumb:hover { background: ${t.scrollbarHover||"rgba(45,212,191,0.5)"}; }
    `,()=>{a&&a.parentNode&&a.parentNode.removeChild(a)}},[t]),S.useEffect(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight,f.current&&f.current.scrollIntoView({behavior:"smooth",block:"nearest"}),requestAnimationFrame(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)}))},[w]),S.useEffect(()=>{const s=a=>{const u=a.data;if(!(!u||!u.type)){if(u.type==="leftText"){const g=u.text||"",I=u.image||null;if(g.trim()||I){let v="ðŸ“– Read left-side content";I&&(v+=" (with screenshot)"),v+=`:
`+(g.slice(0,500)+(g.length>500?"...":"")),h({role:"system",text:v,image:I});let j="";I?j=`Please analyze the following content and screenshot from the left side of the page. Provide a helpful response, summary, or answer any questions found in it. The screenshot may contain images, charts, diagrams, or other visual content that is not in the text:

${g.slice(0,15e3)}`:j=`Please analyze the following content and provide a helpful response, summary, or answer any questions found in it:

${g.slice(0,15e3)}`,C(j,I).then(R=>{R&&R.text&&h({role:"assistant",text:R.text})})}else h({role:"assistant",text:"No content found on the left side of the page. Please make sure there is visible text content."})}if(u.type==="screenshotCaptured"){const g=u.image||null;if(g)h({role:"system",text:`ðŸ“· Full screen screenshot captured

Sending to AI for analysis...`,image:g}),C("Please analyze this full screen screenshot of the webpage. Provide a detailed description, identify any text, images, charts, diagrams, questions, or other visual elements. Answer any questions you see, or provide a comprehensive summary of what's displayed in the image. Pay attention to all parts of the screen including the left and right sides. Negative: Don't describe about the right panel of sidekickAI plugin. You need to answer or describe the left panel only.",g).then(v=>{v&&v.text&&h({role:"assistant",text:v.text})});else{const I=u.error||"Failed to capture screenshot";h({role:"assistant",text:`âŒ Error: ${I}`})}}if(u.type==="screenshotToInput"){const g=u.image||null;if(g)l(g);else{const I=u.error||"Failed to capture screenshot";h({role:"assistant",text:`âŒ Error: ${I}`})}}if(u.type==="quizFound"){const g=u.quiz;h({role:"system",text:"ðŸ“ Quiz found: "+g.question}),g.options&&g.options.length>0&&h({role:"system",text:"Options: "+(g.options.join(" | ")||"None")});const I=g.options&&g.options.length?`Question: ${g.question}
Options:
${g.options.map((v,j)=>`${j+1}. ${v}`).join(`
`)}
Answer with the index and short reason.`:`Please answer: ${g.question}`;C(I).then(v=>{if(v&&v.text){h({role:"assistant",text:v.text});const j=v.text.match(/(\d+)/);if(j&&g.options&&g.options[parseInt(j[1],10)-1]){const R=g.options[parseInt(j[1],10)-1];window.parent.postMessage({type:"highlight",payload:R},"*")}}})}}};return window.addEventListener("message",s),()=>window.removeEventListener("message",s)},[]);function h(s){e(a=>[...a,{...s,id:s.id||Date.now()+Math.random()}])}const z=s=>{const a=w[s];if(!a||a.role!=="user")return;const u=w.slice(0,s+1);e(u),C(a.text,a.image)};async function C(s,a=null){const u=Date.now(),g=u-o.current,I=1e3;if(g<I&&o.current>0){const j=I-g;return h({role:"assistant",text:`â³ Please wait ${Math.ceil(j/1e3)} second(s) before sending another request to avoid rate limits.`}),Promise.resolve(null)}if(d)return h({role:"assistant",text:"â³ Please wait for the current request to complete."}),Promise.resolve(null);m(!0),o.current=u,h(a?{role:"user",text:s,image:a}:{role:"user",text:s});const v=Date.now();return h({role:"assistant",text:"",id:v,isLoading:!0}),new Promise(j=>{chrome.storage.local.get(["ai_settings"],R=>{const T=R.ai_settings||p,D={openai:"gpt-4o",huggingface:"google/flan-t5-xxl",gemini:"gemini-pro",custom:""},A=T.provider||"openai",F=T.model||D[A]||"gpt-4o";console.log("[SidekickAI] Using provider:",A,"model:",F),chrome.runtime.sendMessage({type:"callAPI",payload:{provider:A,model:F,input:{prompt:s},imageData:a}},E=>{if(m(!1),e(y=>y.filter(M=>M.id!==v)),!E||!E.ok){let y=(E==null?void 0:E.error)||"No response";if(y.toLowerCase().includes("quota")||y.toLowerCase().includes("billing")||y.toLowerCase().includes("insufficient"))y=`âš ï¸ Insufficient Quota Error

Your OpenAI account has exceeded its quota or has a billing issue.

Please:
1. Check your billing at https://platform.openai.com/account/billing
2. Verify you have available credits
3. Review your usage limits
4. Update your payment method if needed

Error details: `+y;else if(y.includes("Rate limit")||y.includes("429"))y="âš ï¸ Rate limit exceeded. Please wait a moment and try again. The request will be retried automatically.";else if(y.includes("API key")||y.includes("401")||y.includes("Invalid")||y.includes("key not set")||y.includes("not set")){const M=A==="openai"?"OpenAI":A==="gemini"?"Gemini":A==="huggingface"?"Hugging Face":A;y=`ðŸ”‘ ${M} API key error. Please check your ${M} API key in the settings.

Click the âš™ï¸ Settings button in the header to configure your API keys.`}else(y.includes("402")||y.includes("403"))&&(y="ðŸ’³ Payment or permission error. Please check your OpenAI account billing and API access.");e(M=>[...M.filter(B=>B.id!==v),{role:"assistant",text:"âŒ Error: "+y,id:Date.now()}]),j(null)}else{const y=E.result.text||(typeof E.result=="string"?E.result:JSON.stringify(E.result));e(M=>[...M.filter(B=>B.id!==v),{role:"assistant",text:y,id:Date.now()}]),j({text:y,raw:E.result.raw})}})})})}const L=()=>{if(!c.trim()&&!n||d)return;const s=c.trim()||"Please analyze this screenshot",a=n;k(""),l(null),C(s,a)},W=()=>{l(null)};return r.jsxs("div",{className:"chat-wrapper",style:{padding:"12px 16px"},children:[r.jsxs("div",{className:"chat",ref:b,style:{flex:1,overflowY:"auto",overflowX:"hidden",paddingRight:"6px",display:"flex",flexDirection:"column",gap:"8px",scrollBehavior:"smooth"},children:[w.map((s,a)=>r.jsxs("div",{className:"msg "+(s.role||"assistant")+" message-enter",style:{padding:"12px 14px",borderRadius:"12px",maxWidth:"85%",boxShadow:t.panelShadow||"0 2px 10px rgba(2,6,23,0.4)",transition:"all 0.2s ease",backdropFilter:t.backdrop||"blur(10px)",WebkitBackdropFilter:t.backdrop||"blur(10px)",position:"relative",...s.role==="user"?{alignSelf:"flex-end",background:t.messageUser||"linear-gradient(135deg, rgba(45,212,191,0.15), rgba(96,165,250,0.1))",border:`1px solid ${t.accentBorder||"rgba(45,212,191,0.2)"}`}:{alignSelf:"flex-start",background:t.messageAssistant||"rgba(255,255,255,0.03)",border:`1px solid ${t.panelBorder||"rgba(255,255,255,0.04)"}`}},children:[s.role==="user"&&!s.isLoading&&r.jsx("button",{onClick:()=>z(a),title:"Resend message",style:{position:"absolute",top:"4px",right:"4px",background:"rgba(0,0,0,0.3)",border:"none",borderRadius:"4px",color:t.text||"#e6eef6",cursor:"pointer",padding:"4px 6px",fontSize:"10px",opacity:.6,transition:"opacity 0.2s",display:"flex",alignItems:"center",gap:"2px"},onMouseEnter:u=>{u.target.style.opacity="1",u.target.style.background="rgba(0,0,0,0.5)"},onMouseLeave:u=>{u.target.style.opacity="0.6",u.target.style.background="rgba(0,0,0,0.3)"},children:"â†» Resend"}),s.image&&r.jsxs("div",{style:{marginBottom:"8px",borderRadius:"8px",overflow:"hidden",border:"1px solid rgba(255,255,255,0.1)",maxWidth:"100%"},children:[r.jsx("img",{src:`data:image/png;base64,${s.image}`,alt:"Screenshot",style:{width:"100%",height:"auto",maxHeight:"300px",objectFit:"contain",display:"block",cursor:"pointer"},onClick:()=>{const u=window.open();u&&u.document.write(`
                        <html>
                          <head><title>Screenshot</title></head>
                          <body style="margin:0; padding:20px; background:#000; display:flex; justify-content:center; align-items:center; min-height:100vh;">
                            <img src="data:image/png;base64,${s.image}" style="max-width:100%; max-height:100vh; border:1px solid #333;" />
                          </body>
                        </html>
                      `)},title:"Click to view full size"}),r.jsx("div",{style:{padding:"4px 8px",fontSize:"11px",color:"rgba(255,255,255,0.6)",background:"rgba(0,0,0,0.3)",textAlign:"center"},children:"ðŸ“· Screenshot â€¢ Click to view full size"})]}),s.isLoading?r.jsx(x,{}):r.jsx("div",{style:{whiteSpace:"pre-wrap",margin:0,wordBreak:"break-word",lineHeight:"1.6",color:t.text||"#e6eef6",paddingRight:s.role==="user"?"50px":"0"},children:U(s.text)})]},s.id||a)),r.jsx("div",{ref:f,style:{height:"1px"}})]}),r.jsxs("div",{className:"composer",style:{display:"flex",flexDirection:"column",gap:"8px",padding:"12px 16px",borderTop:`1px solid ${t.panelBorder||"rgba(255,255,255,0.03)"}`,background:t.panel||"rgba(255,255,255,0.02)",backdropFilter:t.backdrop||"blur(10px)",WebkitBackdropFilter:t.backdrop||"blur(10px)"},children:[n&&r.jsxs("div",{style:{position:"relative",borderRadius:"8px",overflow:"hidden",border:`1px solid ${t.panelBorder||"rgba(255,255,255,0.1)"}`,maxWidth:"100%",background:t.panel||"rgba(255,255,255,0.05)"},children:[r.jsx("img",{src:`data:image/png;base64,${n}`,alt:"Screenshot preview",style:{width:"100%",height:"auto",maxHeight:"150px",objectFit:"contain",display:"block"}}),r.jsx("button",{onClick:W,style:{position:"absolute",top:"8px",right:"8px",background:"rgba(0,0,0,0.6)",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:"bold"},title:"Remove screenshot",children:"Ã—"}),r.jsx("div",{style:{padding:"4px 8px",fontSize:"11px",color:t.textSecondary||"rgba(255,255,255,0.6)",background:"rgba(0,0,0,0.3)",textAlign:"center"},children:"ðŸ“· Screenshot ready â€¢ Type a message and click Send"})]}),r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-end"},children:[r.jsx("textarea",{value:c,onChange:s=>k(s.target.value),placeholder:d?"Processing request...":n?"Type a message with the screenshot...":"Type a message...",disabled:d,onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&!d&&(s.preventDefault(),L())},style:{flex:1,minHeight:"56px",resize:"none",padding:"10px 12px",borderRadius:"10px",border:`1px solid ${t.inputBorder||"rgba(255,255,255,0.1)"}`,background:t.input||"rgba(255,255,255,0.05)",color:t.text||"#e6eef6",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",fontSize:"14px",fontFamily:"inherit"}}),r.jsx("button",{onClick:L,disabled:d||!c.trim()&&!n,style:{width:"96px",borderRadius:"10px",border:`1px solid ${t.accentBorder||"rgba(45,212,191,0.3)"}`,cursor:d||!c.trim()&&!n?"not-allowed":"pointer",background:d||!c.trim()&&!n?t.panel||"rgba(255,255,255,0.05)":t.button||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",color:t.text||"#e6eef6",fontWeight:"700",fontSize:"14px",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",opacity:d||!c.trim()&&!n?.5:1,height:"56px"},onMouseEnter:s=>{!d&&(c.trim()||n)&&(s.target.style.background=t.buttonHover||"linear-gradient(90deg, rgba(45,212,191,0.4), rgba(96,165,250,0.4))",s.target.style.transform="scale(1.02)")},onMouseLeave:s=>{s.target.style.background=t.button||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",s.target.style.transform="scale(1)"},children:d?"â³":"Send"})]})]})]})}function Q({theme:p}){const i=(p==null?void 0:p.colors)||{},t=()=>{chrome.runtime.sendMessage({type:"captureScreenshot",includeImage:!0},e=>{chrome.runtime.lastError?(console.error("[SidekickAI] Error capturing screenshot:",chrome.runtime.lastError),window.parent.postMessage({type:"screenshotCaptured",image:null,error:chrome.runtime.lastError.message},"*")):e!=null&&e.ok&&(e!=null&&e.screenshotDataUrl)?window.parent.postMessage({type:"cropAndSendScreenshot",screenshotDataUrl:e.screenshotDataUrl},"*"):window.parent.postMessage({type:"screenshotCaptured",image:null,error:"Failed to capture screenshot"},"*")})},w=()=>{chrome.runtime.sendMessage({type:"captureScreenshot",includeImage:!0},e=>{chrome.runtime.lastError?(console.error("[SidekickAI] Error capturing screenshot:",chrome.runtime.lastError),window.parent.postMessage({type:"screenshotToInput",image:null,error:chrome.runtime.lastError.message},"*")):e!=null&&e.ok&&(e!=null&&e.screenshotDataUrl)?window.parent.postMessage({type:"cropAndAddToInput",screenshotDataUrl:e.screenshotDataUrl},"*"):window.parent.postMessage({type:"screenshotToInput",image:null,error:"Failed to capture screenshot"},"*")})};return r.jsxs("div",{className:"controls",style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"6px",padding:"10px 12px",background:i.panel||"rgba(255,255,255,0.05)",backdropFilter:i.backdrop||"blur(10px)",WebkitBackdropFilter:i.backdrop||"blur(10px)",borderBottom:`1px solid ${i.panelBorder||"rgba(255,255,255,0.1)"}`},children:[r.jsx("button",{onClick:()=>window.parent.postMessage({type:"readLeft"},"*"),style:{background:i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",border:`1px solid ${i.accentBorder||"rgba(45,212,191,0.3)"}`,color:i.text||"#e6eef6",padding:"6px 8px",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"12px",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onMouseEnter:e=>{e.target.style.background=i.buttonHover||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.background=i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",e.target.style.transform="scale(1)"},children:"Read Left"}),r.jsx("button",{onClick:w,style:{background:i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",border:`1px solid ${i.accentBorder||"rgba(45,212,191,0.3)"}`,color:i.text||"#e6eef6",padding:"6px 8px",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"12px",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onMouseEnter:e=>{e.target.style.background=i.buttonHover||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.background=i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",e.target.style.transform="scale(1)"},children:"ðŸ“· Take Screenshot"}),r.jsx("button",{onClick:t,style:{background:i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",border:`1px solid ${i.accentBorder||"rgba(45,212,191,0.3)"}`,color:i.text||"#e6eef6",padding:"6px 8px",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"12px",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onMouseEnter:e=>{e.target.style.background=i.buttonHover||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.background=i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",e.target.style.transform="scale(1)"},children:"ðŸ” Describe"}),r.jsx("button",{onClick:()=>window.parent.postMessage({type:"findQuiz"},"*"),style:{background:i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",border:`1px solid ${i.accentBorder||"rgba(45,212,191,0.3)"}`,color:i.text||"#e6eef6",padding:"6px 8px",borderRadius:"6px",cursor:"pointer",fontWeight:"600",fontSize:"12px",transition:"all 0.2s",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onMouseEnter:e=>{e.target.style.background=i.buttonHover||"linear-gradient(90deg, rgba(45,212,191,0.3), rgba(96,165,250,0.3))",e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.background=i.button||"linear-gradient(90deg, rgba(45,212,191,0.2), rgba(96,165,250,0.2))",e.target.style.transform="scale(1)"},children:"Answer Quiz"})]})}function Y(){const[p,i]=S.useState({provider:"openai",model:"gpt-4o"}),[t,w]=S.useState(q),[e,c]=S.useState(!1),[k,n]=S.useState(420),[l,d]=S.useState(!0);S.useEffect(()=>{if(p.provider&&!p.model){const x={openai:"gpt-4o",huggingface:"google/flan-t5-xxl",gemini:"gemini-pro",custom:""}[p.provider]||"gpt-4o";i(h=>({...h,model:x}))}},[p.provider,p.model]),S.useEffect(()=>{console.log("[SidekickAI] App component mounted, loading settings...");try{if(typeof chrome>"u"||!chrome.runtime){console.error("[SidekickAI] chrome.runtime is not available!"),d(!1);return}chrome.runtime.sendMessage({type:"getSettings"},x=>{chrome.runtime.lastError?console.error("[SidekickAI] Error getting settings:",chrome.runtime.lastError.message):x?(console.log("[SidekickAI] Settings loaded:",x),i(x)):console.warn("[SidekickAI] No settings received, using defaults"),d(!1)}),chrome.storage.local.get(["sidekickai_pinned","sidekickai_theme"],x=>{chrome.runtime.lastError?console.error("[SidekickAI] Error getting storage:",chrome.runtime.lastError.message):(x.sidekickai_pinned!==void 0&&c(x.sidekickai_pinned),x.sidekickai_theme&&w(x.sidekickai_theme)),d(!1)})}catch(x){console.error("[SidekickAI] Error getting settings:",x),d(!1)}const f=x=>{if(!x.data||!x.data.type)return;const h=x.data;h.type==="sidebarState"?(n(h.width||420),c(h.pinned||!1)):h.type==="sidebarResize"?n(h.width||420):h.type==="sidebarPin"&&c(h.pinned||!1)};return window.addEventListener("message",f),()=>window.removeEventListener("message",f)},[]);const m=()=>{try{window.parent.postMessage({type:"togglePin"},"*")}catch(f){console.error("[SidekickAI] Error toggling pin:",f)}},b=N(t),o=b.colors;return l?r.jsx("div",{className:"sidepanel",style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",background:o.background,color:o.text},children:r.jsx("div",{style:{color:o.text},children:"Loading SidekickAI..."})}):r.jsxs("div",{className:"sidepanel",style:{width:"100%",background:o.background,backdropFilter:o.backdrop,WebkitBackdropFilter:o.backdrop,color:o.text,boxShadow:o.panelShadow},children:[r.jsxs("div",{className:"header",style:{background:o.panel,borderBottom:`1px solid ${o.panelBorder}`,backdropFilter:o.backdrop,WebkitBackdropFilter:o.backdrop},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx("img",{src:"assets/logo.svg",alt:"SidekickAI",style:{height:36,marginRight:8},onError:f=>{console.warn("[SidekickAI] Logo failed to load"),f.target.style.display="none"}}),r.jsx("h3",{style:{margin:0,color:o.text},children:"SidekickAI"})]}),r.jsxs("div",{className:"header-actions",style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("button",{onClick:()=>{typeof chrome<"u"&&chrome.tabs&&chrome.tabs.create?chrome.tabs.create({url:"https://chat.openai.com"}):window.open("https://chat.openai.com","_blank","noopener,noreferrer")},title:"Open ChatGPT Web Interface (No API key needed)",style:{background:o.panel,border:`1px solid ${o.panelBorder}`,color:o.text,padding:"4px 8px",fontSize:"12px",cursor:"pointer",borderRadius:"6px",transition:"all 0.2s"},onMouseEnter:f=>{f.target.style.background=o.buttonHover},onMouseLeave:f=>{f.target.style.background=o.panel},children:"ðŸ’¬ ChatGPT"}),r.jsx("button",{onClick:()=>{try{chrome.runtime.openOptionsPage()}catch(f){console.error("[SidekickAI] Error opening options:",f),window.open(chrome.runtime.getURL("options.html"),"_blank")}},title:"Open Settings",style:{background:o.panel,border:`1px solid ${o.panelBorder}`,color:o.text,padding:"4px 8px",fontSize:"12px",cursor:"pointer",borderRadius:"6px",transition:"all 0.2s"},onMouseEnter:f=>{f.target.style.background=o.buttonHover},onMouseLeave:f=>{f.target.style.background=o.panel},children:"âš™ï¸ Settings"}),r.jsx("button",{onClick:m,title:e?"Unpin sidebar":"Pin sidebar",style:{background:e?o.accent:o.panel,border:`1px solid ${e?o.accentBorder:o.panelBorder}`,color:o.text,padding:"4px 8px",fontSize:"12px",borderRadius:"6px",transition:"all 0.2s"},children:e?"ðŸ“Œ Pinned":"ðŸ“Œ Pin"}),r.jsx("button",{onClick:()=>{try{window.parent.postMessage({type:"removeSidebar"},"*")}catch(f){console.error("[SidekickAI] Error closing sidebar:",f)}},style:{background:o.panel,border:`1px solid ${o.panelBorder}`,color:o.text,padding:"4px 8px",fontSize:"12px",borderRadius:"6px",cursor:"pointer"},children:"Close"})]})]}),r.jsx(Q,{theme:b}),r.jsx(O,{settings:p,theme:b})]})}try{const p=document.getElementById("root");p?(H(p).render(r.jsx(Y,{})),console.log("[SidekickAI] React app rendered successfully")):(console.error("[SidekickAI] Root element not found!"),document.body.innerHTML='<div style="padding:20px;color:#fff">Error: Root element not found</div>')}catch(p){console.error("[SidekickAI] Failed to render React app:",p),document.body.innerHTML=`
    <div style="padding:20px;color:#fff;font-family:system-ui">
      <h3>SidekickAI Loading Error</h3>
      <p>${p.message}</p>
      <button onclick="window.location.reload()" style="padding:8px 16px;margin-top:10px;cursor:pointer">Reload</button>
    </div>
  `}
